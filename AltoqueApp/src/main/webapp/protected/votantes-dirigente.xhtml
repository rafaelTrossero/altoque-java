<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:adm="http://github.com/adminfaces"
                template="#{layoutMB.template}">

    <ui:define name="metadata">

        <ui:param name="renderFormAsterisks" value="true"/>
    </ui:define>
    <ui:define name="title">
        Asignar votantes a Dirigente
    </ui:define>
    <ui:define name="body">

        <h:form id="form" prependId="false" >
            <p:focus context="@form"/>
            <p:panel styleClass="box-primary card">

                <div class="ui-g ui-fluid">
                    <div class="ui-sm-12 ui-g-6 ui-g-nopad"> 
                        <div class="ui-sm-12 ui-g-11">
                            <p:outputLabel for="somPastor" value="Dirigente"/>
                        </div>
                        <div class="ui-sm-12 ui-g-11" >
                            <p:selectOneMenu id="somPastor"
                                             converter="entityConverter"
                                             value="#{votanteListMB.pastorSelect}"
                                             >
                                <p:ajax listener="#{votanteListMB.recuperarVotantes}" update="@form, dtAgendaContactos"  event="change" />
                                <f:selectItem itemLabel="Seleccionar.." itemValue="" noSelectionOption="true"/>
                                <f:selectItems value="#{votanteListMB.lstSIPastores}"/>
                            </p:selectOneMenu>
                        </div>
                    </div> 

                </div>
                <p:separator />
                <div class="ui-g ui-fluid">

                    <p:dataTable id="dtAgendaContactos"
                                 paginator="false"
                                 rows="5"

                                 value="#{votanteListMB.lstVotantePastor}"
                                 var="prod" 
                                 emptyMessage="No hay votantes vinculados al Dirigente"
                                 >
                        <f:facet name="header">
                            Votantes vinculados al Dirigente #{votanteListMB.pastorSelect.apeNom}
                        </f:facet>
                        <p:column  headerText="Apellido y Nombre"  >

                            <h:outputText value="#{prod.apenom}" />
                        </p:column>
                        <p:column  headerText="DNI" >

                            <h:outputText value="#{prod.dni}"/>

                        </p:column>
                        <p:column  headerText="Orden" >

                            <h:outputText value="#{prod.orden}"/>

                        </p:column>

                    </p:dataTable>
                </div> 




                <p:growl id="msg" showDetail="true" escape="false" />
                <f:facet name="header">
                    <h:outputText value="Buscar persona para vincular con Dirigente"/>
                </f:facet>
                <p:separator />
                <h:panelGrid columns="4" cellpadding="5">
                    <h:outputLabel for="name" value="DNI:" style="font-weight:bold" />
                    <p:inputText id="name" value="#{votanteListMB.dni}" />
                    <p:commandButton value="Buscar" update="display" actionListener="#{votanteListMB.findCarByDNI2}" icon="pi pi-check" />
                    <h:outputText id="display" value="#{votanteListMB.votador.apenom} #{votanteListMB.votador.dni}" />
                </h:panelGrid>


                <div id="main-buttons" class="hidden-sm hidden-xs">
                    <p:commandButton value="Agregar" action="#{votanteListMB.vincularVotadorDirigente()}" update="@form, dtAgendaContactos "
                                     icon="fa fa-refresh" styleClass="btn-primary"/>
                    <p:spacer width="5" />
                    <p:commandButton value="Vincular" action="#{votanteListMB.confirmarVinculacionVotadorDirigente()}" process="@this"
                                     icon="fa fa-check" styleClass="btn-success"
                                     update="@form, dtAgendaContactos"  resetValues="true"/>

                    <p:spacer width="5"/>
                    <p:commandButton value="Cancelar" immediate="true"
                                     action="/pages/car-list?faces-redirect=true"
                                     process="@this"
                                     icon="fa fa-reply"/>
                </div>



            </p:panel>
            <p:separator />



        </h:form>


    </ui:define>

</ui:composition>
